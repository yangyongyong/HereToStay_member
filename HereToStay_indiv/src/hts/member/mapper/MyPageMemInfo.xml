<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="myPageMemInfo">

	<!-- 1. 회원 정보 가져오기 -->
	<select id="getMember" parameterType="String" resultType="member">
		SELECT * FROM member WHERE mem_id = #{value}
	</select>
	
	<!-- 2. 회원 정보 수정하기 -->
	<update id="infoUpdate" parameterType="member">
		UPDATE member
		SET mem_id = #{memId}, mem_name = #{memName}, mem_pwd = #{memPwd}, mem_tel = #{memTel}, mem_mail = #{memMail}, mem_birth = #{memBirth}, mem_rpwd = #{memRpwd}, mem_mig = #{memMig}
		WHERE mem_id = #{memId}
	</update>
	
	<!-- 3. 회원 별 예약 리스트 가져오기 -->
	<select id="getReserList" parameterType="String" resultType="reservation">
		SELECT pen_name, pen_intro, TO_CHAR(res_indate, 'YYYY-MM-DD') as res_indate,
			   TO_CHAR(res_outdate, 'YYYY-MM-DD') as res_outdate, TO_CHAR(res_tot,'999,999,999') as res_tot
		FROM pension, RESERVATION, room
		WHERE mem_id = #{value} AND pension.pen_id = room.pen_id AND room.rom_id = reservation.rom_id
	</select>
	
	<select id="getReviewList" parameterType="String" resultType="review">
		SELECT rev_title, pen_name, rev_star, rev_status
		FROM review rv, reservation rs, room rm, pension pen
		WHERE pen.pen_id = rm.pen_id AND rs.rom_id = rm.rom_id AND rv.res_id = rs.res_id AND rs.mem_id = #{value}
	</select>
	
</mapper>